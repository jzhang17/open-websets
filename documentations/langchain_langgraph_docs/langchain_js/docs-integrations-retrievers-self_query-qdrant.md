[Skip to main content](#%5F%5Fdocusaurus%5FskipToContent%5Ffallback)

**Help us build the JS tools that power AI apps at companies like Replit, Uber, LinkedIn, GitLab, and more. [Join our team!](https://jobs.ashbyhq.com/langchain/05efa205-8560-43fd-bfcc-3f7697561cfb?utm%5Fsource=https%3A%2F%2Fjs.langchain.com%2F&utm%5Fcampaign=langchainjs%5Fdocs)**

[![ü¶úÔ∏èüîó Langchain](/img/brand/wordmark.png)![ü¶úÔ∏èüîó Langchain](/img/brand/wordmark-dark.png)](/)[Integrations](/docs/integrations/platforms/)[API Reference](https://v03.api.js.langchain.com)

[More](#)
* [People](/docs/people/)
* [Community](/docs/community)
* [Error reference](/docs/troubleshooting/errors)
* [External guides](/docs/additional%5Fresources/tutorials)
* [Contributing](/docs/contributing)

[v0.3](#)
* [v0.3](/docs/introduction)
* [v0.2](https://js.langchain.com/v0.2/docs/introduction)
* [v0.1](https://js.langchain.com/v0.1/docs/get%5Fstarted/introduction)

[ü¶úüîó](#)
* [LangSmith](https://smith.langchain.com)
* [LangSmith Docs](https://docs.smith.langchain.com)
* [LangChain Hub](https://smith.langchain.com/hub)
* [LangServe](https://github.com/langchain-ai/langserve)
* [Python Docs](https://python.langchain.com/)

[Chat](https://chatjs.langchain.com)[](https://github.com/langchain-ai/langchainjs)

Search

* [Providers](/docs/integrations/platforms/)  
   * [Providers](/docs/integrations/platforms/)  
   * [Anthropic](/docs/integrations/platforms/anthropic)  
   * [AWS](/docs/integrations/platforms/aws)  
   * [Google](/docs/integrations/platforms/google)  
   * [Microsoft](/docs/integrations/platforms/microsoft)  
   * [OpenAI](/docs/integrations/platforms/openai)
* [Components](/docs/integrations/components)  
   * [Chat models](/docs/integrations/chat/)  
         * [Chat models](/docs/integrations/chat/)  
         * [Alibaba Tongyi](/docs/integrations/chat/alibaba%5Ftongyi)  
         * [Anthropic](/docs/integrations/chat/anthropic)  
         * [Arcjet Redact](/docs/integrations/chat/arcjet)  
         * [Azure OpenAI](/docs/integrations/chat/azure)  
         * [Baidu Qianfan](/docs/integrations/chat/baidu%5Fqianfan)  
         * [Baidu Wenxin](/docs/integrations/chat/baidu%5Fwenxin)  
         * [Amazon Bedrock](/docs/integrations/chat/bedrock)  
         * [Amazon Bedrock Converse](/docs/integrations/chat/bedrock%5Fconverse)  
         * [Cerebras](/docs/integrations/chat/cerebras)  
         * [Cloudflare Workers AI](/docs/integrations/chat/cloudflare%5Fworkersai)  
         * [Cohere](/docs/integrations/chat/cohere)  
         * [Deep Infra](/docs/integrations/chat/deep%5Finfra)  
         * [DeepSeek](/docs/integrations/chat/deepseek)  
         * [DeepSeek](/docs/integrations/chat/deepseek)  
         * [Fake LLM](/docs/integrations/chat/fake)  
         * [Fireworks](/docs/integrations/chat/fireworks)  
         * [Friendli](/docs/integrations/chat/friendli)  
         * [Google GenAI](/docs/integrations/chat/google%5Fgenerativeai)  
         * [Google Vertex AI](/docs/integrations/chat/google%5Fvertex%5Fai)  
         * [Groq](/docs/integrations/chat/groq)  
         * [IBM watsonx.ai](/docs/integrations/chat/ibm)  
         * [Llama CPP](/docs/integrations/chat/llama%5Fcpp)  
         * [Minimax](/docs/integrations/chat/minimax)  
         * [MistralAI](/docs/integrations/chat/mistral)  
         * [Moonshot](/docs/integrations/chat/moonshot)  
         * [NIBittensorChatModel](/docs/integrations/chat/ni%5Fbittensor)  
         * [Novita AI](/docs/integrations/chat/novita)  
         * [Ollama](/docs/integrations/chat/ollama)  
         * [Ollama Functions](/docs/integrations/chat/ollama%5Ffunctions)  
         * [OpenAI](/docs/integrations/chat/openai)  
         * [Perplexity](/docs/integrations/chat/perplexity)  
         * [Perplexity](/docs/integrations/chat/perplexity)  
         * [PremAI](/docs/integrations/chat/premai)  
         * [PromptLayer OpenAI](/docs/integrations/chat/prompt%5Flayer%5Fopenai)  
         * [Tencent Hunyuan](/docs/integrations/chat/tencent%5Fhunyuan)  
         * [Together](/docs/integrations/chat/togetherai)  
         * [WebLLM](/docs/integrations/chat/web%5Fllm)  
         * [xAI](/docs/integrations/chat/xai)  
         * [YandexGPT](/docs/integrations/chat/yandex)  
         * [ZhipuAI](/docs/integrations/chat/zhipuai)  
   * [LLMs](/docs/integrations/llms/)  
         * [LLMs](/docs/integrations/llms/)  
         * [AI21](/docs/integrations/llms/ai21)  
         * [AlephAlpha](/docs/integrations/llms/aleph%5Falpha)  
         * [Arcjet Redact](/docs/integrations/llms/arcjet)  
         * [AWS SageMakerEndpoint](/docs/integrations/llms/aws%5Fsagemaker)  
         * [Azure OpenAI](/docs/integrations/llms/azure)  
         * [Bedrock](/docs/integrations/llms/bedrock)  
         * [ChromeAI](/docs/integrations/llms/chrome%5Fai)  
         * [Cloudflare Workers AI](/docs/integrations/llms/cloudflare%5Fworkersai)  
         * [Cohere](/docs/integrations/llms/cohere)  
         * [Deep Infra](/docs/integrations/llms/deep%5Finfra)  
         * [Fireworks](/docs/integrations/llms/fireworks)  
         * [Friendli](/docs/integrations/llms/friendli)  
         * [Google Vertex AI](/docs/integrations/llms/google%5Fvertex%5Fai)  
         * [Gradient AI](/docs/integrations/llms/gradient%5Fai)  
         * [HuggingFaceInference](/docs/integrations/llms/huggingface%5Finference)  
         * [IBM watsonx.ai](/docs/integrations/llms/ibm)  
         * [JigsawStack Prompt Engine](/docs/integrations/llms/jigsawstack)  
         * [Layerup Security](/docs/integrations/llms/layerup%5Fsecurity)  
         * [Llama CPP](/docs/integrations/llms/llama%5Fcpp)  
         * [MistralAI](/docs/integrations/llms/mistral)  
         * [NIBittensor](/docs/integrations/llms/ni%5Fbittensor)  
         * [Ollama](/docs/integrations/llms/ollama)  
         * [OpenAI](/docs/integrations/llms/openai)  
         * [PromptLayer OpenAI](/docs/integrations/llms/prompt%5Flayer%5Fopenai)  
         * [RaycastAI](/docs/integrations/llms/raycast)  
         * [Replicate](/docs/integrations/llms/replicate)  
         * [Together AI](/docs/integrations/llms/together)  
         * [Writer](/docs/integrations/llms/writer)  
         * [YandexGPT](/docs/integrations/llms/yandex)  
   * [Embedding models](/docs/integrations/text%5Fembedding/)  
         * [Embeddings](/docs/integrations/text%5Fembedding/)  
         * [Alibaba Tongyi](/docs/integrations/text%5Fembedding/alibaba%5Ftongyi)  
         * [Azure OpenAI](/docs/integrations/text%5Fembedding/azure%5Fopenai)  
         * [Baidu Qianfan](/docs/integrations/text%5Fembedding/baidu%5Fqianfan)  
         * [Amazon Bedrock](/docs/integrations/text%5Fembedding/bedrock)  
         * [ByteDance Doubao](/docs/integrations/text%5Fembedding/bytedance%5Fdoubao)  
         * [Cloudflare Workers AI](/docs/integrations/text%5Fembedding/cloudflare%5Fai)  
         * [Cohere](/docs/integrations/text%5Fembedding/cohere)  
         * [DeepInfra](/docs/integrations/text%5Fembedding/deepinfra)  
         * [Fireworks](/docs/integrations/text%5Fembedding/fireworks)  
         * [Google Generative AI](/docs/integrations/text%5Fembedding/google%5Fgenerativeai)  
         * [Google Vertex AI](/docs/integrations/text%5Fembedding/google%5Fvertex%5Fai)  
         * [Gradient AI](/docs/integrations/text%5Fembedding/gradient%5Fai)  
         * [HuggingFace Inference](/docs/integrations/text%5Fembedding/hugging%5Fface%5Finference)  
         * [IBM watsonx.ai](/docs/integrations/text%5Fembedding/ibm)  
         * [Jina](/docs/integrations/text%5Fembedding/jina)  
         * [Llama CPP](/docs/integrations/text%5Fembedding/llama%5Fcpp)  
         * [Minimax](/docs/integrations/text%5Fembedding/minimax)  
         * [MistralAI](/docs/integrations/text%5Fembedding/mistralai)  
         * [Mixedbread AI](/docs/integrations/text%5Fembedding/mixedbread%5Fai)  
         * [Nomic](/docs/integrations/text%5Fembedding/nomic)  
         * [Ollama](/docs/integrations/text%5Fembedding/ollama)  
         * [OpenAI](/docs/integrations/text%5Fembedding/openai)  
         * [Pinecone](/docs/integrations/text%5Fembedding/pinecone)  
         * [Prem AI](/docs/integrations/text%5Fembedding/premai)  
         * [Tencent Hunyuan](/docs/integrations/text%5Fembedding/tencent%5Fhunyuan)  
         * [TensorFlow](/docs/integrations/text%5Fembedding/tensorflow)  
         * [TogetherAI](/docs/integrations/text%5Fembedding/togetherai)  
         * [HuggingFace Transformers](/docs/integrations/text%5Fembedding/transformers)  
         * [Voyage AI](/docs/integrations/text%5Fembedding/voyageai)  
         * [ZhipuAI](/docs/integrations/text%5Fembedding/zhipuai)  
   * [Document loaders](/docs/integrations/document%5Floaders/)  
   * [Vector stores](/docs/integrations/vectorstores/)  
         * [Vector stores](/docs/integrations/vectorstores/)  
         * [AnalyticDB](/docs/integrations/vectorstores/analyticdb)  
         * [Astra DB](/docs/integrations/vectorstores/astradb)  
         * [Azion EdgeSQL](/docs/integrations/vectorstores/azion-edgesql)  
         * [Azion EdgeSQL](/docs/integrations/vectorstores/azion-edgesql)  
         * [Azure AI Search](/docs/integrations/vectorstores/azure%5Faisearch)  
         * [Azure Cosmos DB for MongoDB vCore](/docs/integrations/vectorstores/azure%5Fcosmosdb%5Fmongodb)  
         * [Azure Cosmos DB for NoSQL](/docs/integrations/vectorstores/azure%5Fcosmosdb%5Fnosql)  
         * [Cassandra](/docs/integrations/vectorstores/cassandra)  
         * [Chroma](/docs/integrations/vectorstores/chroma)  
         * [ClickHouse](/docs/integrations/vectorstores/clickhouse)  
         * [CloseVector](/docs/integrations/vectorstores/closevector)  
         * [Cloudflare Vectorize](/docs/integrations/vectorstores/cloudflare%5Fvectorize)  
         * [Convex](/docs/integrations/vectorstores/convex)  
         * [Couchbase](/docs/integrations/vectorstores/couchbase)  
         * [Elasticsearch](/docs/integrations/vectorstores/elasticsearch)  
         * [Faiss](/docs/integrations/vectorstores/faiss)  
         * [Google Cloud SQL for PostgreSQL](/docs/integrations/vectorstores/google%5Fcloudsql%5Fpg)  
         * [Google Cloud SQL for PostgreSQL](/docs/integrations/vectorstores/google%5Fcloudsql%5Fpg)  
         * [Google Vertex AI Matching Engine](/docs/integrations/vectorstores/googlevertexai)  
         * [SAP HANA Cloud Vector Engine](/docs/integrations/vectorstores/hanavector)  
         * [HNSWLib](/docs/integrations/vectorstores/hnswlib)  
         * [LanceDB](/docs/integrations/vectorstores/lancedb)  
         * [libSQL](/docs/integrations/vectorstores/libsql)  
         * [MariaDB](/docs/integrations/vectorstores/mariadb)  
         * [In-memory](/docs/integrations/vectorstores/memory)  
         * [Milvus](/docs/integrations/vectorstores/milvus)  
         * [Momento Vector Index (MVI)](/docs/integrations/vectorstores/momento%5Fvector%5Findex)  
         * [MongoDB Atlas](/docs/integrations/vectorstores/mongodb%5Fatlas)  
         * [MyScale](/docs/integrations/vectorstores/myscale)  
         * [Neo4j Vector Index](/docs/integrations/vectorstores/neo4jvector)  
         * [Neon Postgres](/docs/integrations/vectorstores/neon)  
         * [OpenSearch](/docs/integrations/vectorstores/opensearch)  
         * [PGVector](/docs/integrations/vectorstores/pgvector)  
         * [Pinecone](/docs/integrations/vectorstores/pinecone)  
         * [Prisma](/docs/integrations/vectorstores/prisma)  
         * [Qdrant](/docs/integrations/vectorstores/qdrant)  
         * [Redis](/docs/integrations/vectorstores/redis)  
         * [Rockset](/docs/integrations/vectorstores/rockset)  
         * [SingleStore](/docs/integrations/vectorstores/singlestore)  
         * [Supabase](/docs/integrations/vectorstores/supabase)  
         * [Tigris](/docs/integrations/vectorstores/tigris)  
         * [Turbopuffer](/docs/integrations/vectorstores/turbopuffer)  
         * [TypeORM](/docs/integrations/vectorstores/typeorm)  
         * [Typesense](/docs/integrations/vectorstores/typesense)  
         * [Upstash Vector](/docs/integrations/vectorstores/upstash)  
         * [USearch](/docs/integrations/vectorstores/usearch)  
         * [Vectara](/docs/integrations/vectorstores/vectara)  
         * [Vercel Postgres](/docs/integrations/vectorstores/vercel%5Fpostgres)  
         * [Voy](/docs/integrations/vectorstores/voy)  
         * [Weaviate](/docs/integrations/vectorstores/weaviate)  
         * [Xata](/docs/integrations/vectorstores/xata)  
         * [Zep Open Source](/docs/integrations/vectorstores/zep)  
         * [Zep Cloud](/docs/integrations/vectorstores/zep%5Fcloud)  
   * [Retrievers](/docs/integrations/retrievers/)  
         * [Retrievers](/docs/integrations/retrievers/)  
         * [ArxivRetriever](/docs/integrations/retrievers/arxiv-retriever)  
         * [Azion EdgeSQL](/docs/integrations/retrievers/azion-edgesql)  
         * [Azion EdgeSQL](/docs/integrations/retrievers/azion-edgesql)  
         * [Knowledge Bases for Amazon Bedrock](/docs/integrations/retrievers/bedrock-knowledge-bases)  
         * [BM25](/docs/integrations/retrievers/bm25)  
         * [Chaindesk Retriever](/docs/integrations/retrievers/chaindesk-retriever)  
         * [ChatGPT Plugin Retriever](/docs/integrations/retrievers/chatgpt-retriever-plugin)  
         * [Dria Retriever](/docs/integrations/retrievers/dria)  
         * [Exa](/docs/integrations/retrievers/exa)  
         * [HyDE Retriever](/docs/integrations/retrievers/hyde)  
         * [Amazon Kendra Retriever](/docs/integrations/retrievers/kendra-retriever)  
         * [Metal Retriever](/docs/integrations/retrievers/metal-retriever)  
         * [Self-querying retrievers](/docs/integrations/retrievers/self%5Fquery/)  
                  * [Chroma](/docs/integrations/retrievers/self%5Fquery/chroma)  
                  * [HNSWLib](/docs/integrations/retrievers/self%5Fquery/hnswlib)  
                  * [In-memory](/docs/integrations/retrievers/self%5Fquery/memory)  
                  * [Pinecone](/docs/integrations/retrievers/self%5Fquery/pinecone)  
                  * [Qdrant](/docs/integrations/retrievers/self%5Fquery/qdrant)  
                  * [Supabase](/docs/integrations/retrievers/self%5Fquery/supabase)  
                  * [Vectara](/docs/integrations/retrievers/self%5Fquery/vectara)  
                  * [Weaviate](/docs/integrations/retrievers/self%5Fquery/weaviate)  
         * [Supabase Hybrid Search](/docs/integrations/retrievers/supabase-hybrid)  
         * [Tavily Search API](/docs/integrations/retrievers/tavily)  
         * [Time-Weighted Retriever](/docs/integrations/retrievers/time-weighted-retriever)  
         * [Vespa Retriever](/docs/integrations/retrievers/vespa-retriever)  
         * [Zep Cloud Retriever](/docs/integrations/retrievers/zep-cloud-retriever)  
         * [Zep Open Source Retriever](/docs/integrations/retrievers/zep-retriever)  
   * [Tools/Toolkits](/docs/integrations/tools/)  
         * [Tools and Toolkits](/docs/integrations/tools/)  
         * [ChatGPT Plugins](/docs/integrations/tools/aiplugin-tool)  
         * [Azure Container Apps Dynamic Sessions](/docs/integrations/tools/azure%5Fdynamic%5Fsessions)  
         * [Connery Action Tool](/docs/integrations/tools/connery)  
         * [Dall-E Tool](/docs/integrations/tools/dalle)  
         * [Discord Tool](/docs/integrations/tools/discord)  
         * [DuckDuckGoSearch](/docs/integrations/tools/duckduckgo%5Fsearch)  
         * [ExaSearchResults](/docs/integrations/tools/exa%5Fsearch)  
         * [Gmail Tool](/docs/integrations/tools/gmail)  
         * [GOAT](/docs/integrations/tools/goat)  
         * [Google Calendar Tool](/docs/integrations/tools/google%5Fcalendar)  
         * [Google Places Tool](/docs/integrations/tools/google%5Fplaces)  
         * [Google Routes Tool](/docs/integrations/tools/google%5Froutes)  
         * [Google Scholar](/docs/integrations/tools/google%5Fscholar)  
         * [Google Trends Tool](/docs/integrations/tools/google%5Ftrends)  
         * [JigsawStack Tool](/docs/integrations/tools/jigsawstack)  
         * [Agent with AWS Lambda](/docs/integrations/tools/lambda%5Fagent)  
         * [Python interpreter tool](/docs/integrations/tools/pyinterpreter)  
         * [SearchApi tool](/docs/integrations/tools/searchapi)  
         * [Searxng Search tool](/docs/integrations/tools/searxng)  
         * [SerpAPI](/docs/integrations/tools/serpapi)  
         * [StackExchange Tool](/docs/integrations/tools/stackexchange)  
         * [Stagehand AI Web Automation Toolkit](/docs/integrations/tools/stagehand)  
         * [Tavily Extract](/docs/integrations/tools/tavily%5Fextract)  
         * [Tavily Search](/docs/integrations/tools/tavily%5Fsearch)  
         * [Tavily Search (Community, Deprecated)](/docs/integrations/tools/tavily%5Fsearch%5Fcommunity)  
         * [Web Browser Tool](/docs/integrations/tools/webbrowser)  
         * [Wikipedia tool](/docs/integrations/tools/wikipedia)  
         * [WolframAlpha Tool](/docs/integrations/tools/wolframalpha)  
         * [Agent with Zapier NLA Integration](/docs/integrations/tools/zapier%5Fagent)  
   * [Toolkits](/docs/integrations/tools/)  
         * [Toolkits](/docs/integrations/toolkits/)  
         * [Connery Toolkit](/docs/integrations/toolkits/connery)  
         * [WatsonxToolkit](/docs/integrations/toolkits/ibm)  
         * [WatsonxToolkit](/docs/integrations/toolkits/ibm)  
         * [JSON Agent Toolkit](/docs/integrations/toolkits/json)  
         * [OpenApi Toolkit](/docs/integrations/toolkits/openapi)  
         * [AWS Step Functions Toolkit](/docs/integrations/toolkits/sfn%5Fagent)  
         * [Sql Toolkit](/docs/integrations/toolkits/sql)  
         * [VectorStore Toolkit](/docs/integrations/toolkits/vectorstore)  
   * [Key-value stores](/docs/integrations/stores/)  
         * [Cassandra KV](/docs/integrations/stores/cassandra%5Fstorage)  
         * [File System Store](/docs/integrations/stores/file%5Fsystem)  
         * [InMemory Store](/docs/integrations/stores/in%5Fmemory)  
         * [Key-value stores](/docs/integrations/stores/)  
         * [IORedis](/docs/integrations/stores/ioredis%5Fstorage)  
         * [Upstash Redis](/docs/integrations/stores/upstash%5Fredis%5Fstorage)  
         * [Vercel KV](/docs/integrations/stores/vercel%5Fkv%5Fstorage)  
   * [Other](/docs/integrations/document%5Ftransformers)

* [Components](/docs/integrations/components)
* [Retrievers](/docs/integrations/retrievers/)
* [Self-querying retrievers](/docs/integrations/retrievers/self%5Fquery/)
* Qdrant

On this page

# Qdrant

This guide will help you getting started with such a retriever backed by a [Qdrant vector store](/docs/integrations/vectorstores/qdrant). For detailed documentation of all features and configurations head to the[API reference](https://api.js.langchain.com/classes/langchain.retrievers%5Fself%5Fquery.SelfQueryRetriever.html).

## Overview[‚Äã](#overview "Direct link to Overview")

A [self-query retriever](/docs/how%5Fto/self%5Fquery/) retrieves documents by dynamically generating metadata filters based on some input query. This allows the retriever to account for underlying document metadata in addition to pure semantic similarity when fetching results.

It uses a module called a `Translator` that generates a filter based on information about metadata fields and the query language that a given vector store supports.

### Integration details[‚Äã](#integration-details "Direct link to Integration details")

| Backing vector store                                                                                | Self-host | Cloud offering | Package                                                              | [Py support](https://python.langchain.com/docs/integrations/retrievers/self%5Fquery/qdrant%5Fself%5Fquery/) |
| --------------------------------------------------------------------------------------------------- | --------- | -------------- | -------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| [QdrantVectorStore](https://api.js.langchain.com/classes/langchain%5Fqdrant.QdrantVectorStore.html) | ‚úÖ         | ‚úÖ              | [@langchain/qdrant](https://www.npmjs.com/package/@langchain/qdrant) | ‚úÖ                                                                                                           |

## Setup[‚Äã](#setup "Direct link to Setup")

Set up a Qdrant instance as documented[here](/docs/integrations/vectorstores/qdrant). Set the following environment variables:

```
process.env.QDRANT_URL = "YOUR_QDRANT_URL_HERE"; // for example, http://localhost:6333

```

If you want to get automated tracing from individual queries, you can also set your [LangSmith](https://docs.smith.langchain.com/) API key by uncommenting below:

```
// process.env.LANGSMITH_API_KEY = "<YOUR API KEY HERE>";
// process.env.LANGSMITH_TRACING = "true";

```

### Installation[‚Äã](#installation "Direct link to Installation")

The vector store lives in the `@langchain/qdrant` package. You‚Äôll also need to install the `langchain` and `@langchain/community` packages to import the main `SelfQueryRetriever` classes.

For this example, we‚Äôll also use OpenAI embeddings, so you‚Äôll need to install the `@langchain/openai` package and [obtain an API key](https://platform.openai.com):

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/qdrant langchain @langchain/community @langchain/openai @langchain/core

```

```
yarn add @langchain/qdrant langchain @langchain/community @langchain/openai @langchain/core

```

```
pnpm add @langchain/qdrant langchain @langchain/community @langchain/openai @langchain/core

```

The official Qdrant SDK (`@qdrant/js-client-rest`) is automatically installed as a dependency of `@langchain/qdrant`, but you may wish to install it independently as well.

## Instantiation[‚Äã](#instantiation "Direct link to Instantiation")

First, initialize your Qdrant vector store with some documents that contain metadata:

```
import { OpenAIEmbeddings } from "@langchain/openai";
import { QdrantVectorStore } from "@langchain/qdrant";
import { Document } from "@langchain/core/documents";
import type { AttributeInfo } from "langchain/chains/query_constructor";

import { QdrantClient } from "@qdrant/js-client-rest";

/**
 * First, we create a bunch of documents. You can load your own documents here instead.
 * Each document has a pageContent and a metadata field. Make sure your metadata matches the AttributeInfo below.
 */
const docs = [
  new Document({
    pageContent:
      "A bunch of scientists bring back dinosaurs and mayhem breaks loose",
    metadata: { year: 1993, rating: 7.7, genre: "science fiction" },
  }),
  new Document({
    pageContent:
      "Leo DiCaprio gets lost in a dream within a dream within a dream within a ...",
    metadata: { year: 2010, director: "Christopher Nolan", rating: 8.2 },
  }),
  new Document({
    pageContent:
      "A psychologist / detective gets lost in a series of dreams within dreams within dreams and Inception reused the idea",
    metadata: { year: 2006, director: "Satoshi Kon", rating: 8.6 },
  }),
  new Document({
    pageContent:
      "A bunch of normal-sized women are supremely wholesome and some men pine after them",
    metadata: { year: 2019, director: "Greta Gerwig", rating: 8.3 },
  }),
  new Document({
    pageContent: "Toys come alive and have a blast doing so",
    metadata: { year: 1995, genre: "animated" },
  }),
  new Document({
    pageContent: "Three men walk into the Zone, three men walk out of the Zone",
    metadata: {
      year: 1979,
      director: "Andrei Tarkovsky",
      genre: "science fiction",
      rating: 9.9,
    },
  }),
];

/**
 * Next, we define the attributes we want to be able to query on.
 * in this case, we want to be able to query on the genre, year, director, rating, and length of the movie.
 * We also provide a description of each attribute and the type of the attribute.
 * This is used to generate the query prompts.
 */
const attributeInfo: AttributeInfo[] = [
  {
    name: "genre",
    description: "The genre of the movie",
    type: "string or array of strings",
  },
  {
    name: "year",
    description: "The year the movie was released",
    type: "number",
  },
  {
    name: "director",
    description: "The director of the movie",
    type: "string",
  },
  {
    name: "rating",
    description: "The rating of the movie (1-10)",
    type: "number",
  },
  {
    name: "length",
    description: "The length of the movie in minutes",
    type: "number",
  },
];

/**
 * Next, we instantiate a vector store. This is where we store the embeddings of the documents.
 * We also need to provide an embeddings object. This is used to embed the documents.
 */

const client = new QdrantClient({ url: process.env.QDRANT_URL });

const embeddings = new OpenAIEmbeddings();
const vectorStore = await QdrantVectorStore.fromDocuments(docs, embeddings, {
  client,
  collectionName: "movie-collection",
});

```

Now we can instantiate our retriever:

### Pick your chat model:

* Groq
* OpenAI
* Anthropic
* Google Gemini
* FireworksAI
* MistralAI
* VertexAI

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/groq 

```

```
yarn add @langchain/groq 

```

```
pnpm add @langchain/groq 

```

#### Add environment variables

```
GROQ_API_KEY=your-api-key

```

#### Instantiate the model

```
import { ChatGroq } from "@langchain/groq";

const llm = new ChatGroq({
  model: "llama-3.3-70b-versatile",
  temperature: 0
});

```

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/openai 

```

```
yarn add @langchain/openai 

```

```
pnpm add @langchain/openai 

```

#### Add environment variables

```
OPENAI_API_KEY=your-api-key

```

#### Instantiate the model

```
import { ChatOpenAI } from "@langchain/openai";

const llm = new ChatOpenAI({
  model: "gpt-4o-mini",
  temperature: 0
});

```

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/anthropic 

```

```
yarn add @langchain/anthropic 

```

```
pnpm add @langchain/anthropic 

```

#### Add environment variables

```
ANTHROPIC_API_KEY=your-api-key

```

#### Instantiate the model

```
import { ChatAnthropic } from "@langchain/anthropic";

const llm = new ChatAnthropic({
  model: "claude-3-5-sonnet-20240620",
  temperature: 0
});

```

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/google-genai 

```

```
yarn add @langchain/google-genai 

```

```
pnpm add @langchain/google-genai 

```

#### Add environment variables

```
GOOGLE_API_KEY=your-api-key

```

#### Instantiate the model

```
import { ChatGoogleGenerativeAI } from "@langchain/google-genai";

const llm = new ChatGoogleGenerativeAI({
  model: "gemini-2.0-flash",
  temperature: 0
});

```

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/community 

```

```
yarn add @langchain/community 

```

```
pnpm add @langchain/community 

```

#### Add environment variables

```
FIREWORKS_API_KEY=your-api-key

```

#### Instantiate the model

```
import { ChatFireworks } from "@langchain/community/chat_models/fireworks";

const llm = new ChatFireworks({
  model: "accounts/fireworks/models/llama-v3p1-70b-instruct",
  temperature: 0
});

```

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/mistralai 

```

```
yarn add @langchain/mistralai 

```

```
pnpm add @langchain/mistralai 

```

#### Add environment variables

```
MISTRAL_API_KEY=your-api-key

```

#### Instantiate the model

```
import { ChatMistralAI } from "@langchain/mistralai";

const llm = new ChatMistralAI({
  model: "mistral-large-latest",
  temperature: 0
});

```

#### Install dependencies

tip

See [this section for general instructions on installing integration packages](/docs/how%5Fto/installation/#installing-integration-packages).

* npm
* yarn
* pnpm

```
npm i @langchain/google-vertexai 

```

```
yarn add @langchain/google-vertexai 

```

```
pnpm add @langchain/google-vertexai 

```

#### Add environment variables

```
GOOGLE_APPLICATION_CREDENTIALS=credentials.json

```

#### Instantiate the model

```
import { ChatVertexAI } from "@langchain/google-vertexai";

const llm = new ChatVertexAI({
  model: "gemini-1.5-flash",
  temperature: 0
});

```

```
import { SelfQueryRetriever } from "langchain/retrievers/self_query";
import { QdrantTranslator } from "@langchain/community/structured_query/qdrant";

const selfQueryRetriever = SelfQueryRetriever.fromLLM({
  llm: llm,
  vectorStore: vectorStore,
  /** A short summary of what the document contents represent. */
  documentContents: "Brief summary of a movie",
  attributeInfo: attributeInfo,
  structuredQueryTranslator: new QdrantTranslator(),
});

```

## Usage[‚Äã](#usage "Direct link to Usage")

Now, ask a question that requires some knowledge of the document‚Äôs metadata to answer. You can see that the retriever will generate the correct result:

```
await selfQueryRetriever.invoke("Which movies are rated higher than 8.5?");

```

```
[
  Document {
    pageContent: 'A psychologist / detective gets lost in a series of dreams within dreams within dreams and Inception reused the idea',
    metadata: { director: 'Satoshi Kon', rating: 8.6, year: 2006 },
    id: undefined
  },
  Document {
    pageContent: 'Three men walk into the Zone, three men walk out of the Zone',
    metadata: {
      director: 'Andrei Tarkovsky',
      genre: 'science fiction',
      rating: 9.9,
      year: 1979
    },
    id: undefined
  }
]

```

## Use within a chain[‚Äã](#use-within-a-chain "Direct link to Use within a chain")

Like other retrievers, Qdrant self-query retrievers can be incorporated into LLM applications via [chains](/docs/how%5Fto/sequence/).

Note that because their returned answers can heavily depend on document metadata, we format the retrieved documents differently to include that information.

```
import { ChatPromptTemplate } from "@langchain/core/prompts";
import {
  RunnablePassthrough,
  RunnableSequence,
} from "@langchain/core/runnables";
import { StringOutputParser } from "@langchain/core/output_parsers";

import type { Document } from "@langchain/core/documents";

const prompt = ChatPromptTemplate.fromTemplate(`
Answer the question based only on the context provided.

Context: {context}

Question: {question}`);

const formatDocs = (docs: Document[]) => {
  return docs.map((doc) => JSON.stringify(doc)).join("\n\n");
};

// See https://js.langchain.com/docs/tutorials/rag
const ragChain = RunnableSequence.from([
  {
    context: selfQueryRetriever.pipe(formatDocs),
    question: new RunnablePassthrough(),
  },
  prompt,
  llm,
  new StringOutputParser(),
]);

```

```
await ragChain.invoke("Which movies are rated higher than 8.5?");

```

```
The movies rated higher than 8.5 are the ones directed by Satoshi Kon (rating: 8.6) and Andrei Tarkovsky (rating: 9.9).

```

## Default search params[‚Äã](#default-search-params "Direct link to Default search params")

You can also pass a `searchParams` field into the above method that provides default filters applied in addition to any generated query. The filter syntax is the same as the backing Qdrant vector store:

```
const selfQueryRetrieverWithDefaultParams = SelfQueryRetriever.fromLLM({
  llm: llm,
  vectorStore: vectorStore,
  documentContents: "Brief summary of a movie",
  attributeInfo: attributeInfo,
  structuredQueryTranslator: new QdrantTranslator(),
  searchParams: {
    filter: {
      must: [
        {
          key: "metadata.rating",
          range: {
            gt: 8.5,
          },
        },
      ],
    },
    mergeFiltersOperator: "and",
  },
});

```

## API reference[‚Äã](#api-reference "Direct link to API reference")

For detailed documentation of all Qdrant self-query retriever features and configurations head to the [API reference](https://api.js.langchain.com/classes/langchain.retrievers%5Fself%5Fquery.SelfQueryRetriever.html).

---

#### Was this page helpful?

  
#### You can also leave detailed feedback [on GitHub](https://github.com/langchain-ai/langchainjs/issues/new?assignees=&labels=03+-+Documentation&projects=&template=documentation.yml&title=DOC%3A+%3CPlease+write+a+comprehensive+title+after+the+%27DOC%3A+%27+prefix%3E).

[PreviousPinecone](/docs/integrations/retrievers/self%5Fquery/pinecone)[NextSupabase](/docs/integrations/retrievers/self%5Fquery/supabase)

* [Overview](#overview)  
   * [Integration details](#integration-details)
* [Setup](#setup)  
   * [Installation](#installation)
* [Instantiation](#instantiation)
* [Usage](#usage)
* [Use within a chain](#use-within-a-chain)
* [Default search params](#default-search-params)
* [API reference](#api-reference)

Community

* [Twitter](https://twitter.com/LangChainAI)

GitHub

* [Python](https://github.com/langchain-ai/langchain)
* [JS/TS](https://github.com/langchain-ai/langchainjs)

More

* [Homepage](https://langchain.com)
* [Blog](https://blog.langchain.dev)

Copyright ¬© 2025 LangChain, Inc.